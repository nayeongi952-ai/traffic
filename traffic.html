<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Traffic Light</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(#8fd4ff, #bfe7ff);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* ì „ì²´ ì»¨í…Œì´ë„ˆ */
  .traffic-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* ì‹ í˜¸ë“± ë³¸ì²´(ì¶•ì†Œëœ ë²„ì „) */
  .traffic-body {
    width: 150px;            /* ì¶•ì†Œ */
    background: #1b1b1b;
    padding: 18px 0;         /* ê°„ê²© ì¶•ì†Œ */
    border-radius: 20px;
    box-shadow: 0 12px 25px rgba(0,0,0,0.4);
    display: flex;
    flex-direction: column;
    gap: 25px;               /* ë¨í”„ ê°„ ê±°ë¦¬ ì¶•ì†Œ */
  }

  /* ê°œë³„ ë¨í”„ ë°•ìŠ¤ */
  .lamp-box {
    width: 120px;           /* ì¶•ì†Œ */
    height: 120px;          
    background: #111;
    border-radius: 30px;
    margin: auto;
    position: relative;
    box-shadow: inset 0 0 25px rgba(0,0,0,0.7);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* ë™ê·¸ë¼ë¯¸ ë¨í”„ */
  .lamp {
    width: 95px;        /* ì¶•ì†Œ + ì•½ê°„ í¬ê²Œ ì¡°ì • */
    height: 95px;
    border-radius: 50%;
    background: #333;
    transition: 0.2s;
    box-shadow: inset 0 0 35px rgba(0,0,0,0.8);
  }

  /* â”€â”€â”€â”€â”€ ë¶ˆ ì¼œì§€ëŠ” íš¨ê³¼ â”€â”€â”€â”€â”€ */
  .red.on {
    background: radial-gradient(circle, #ffdddd, #ff0000 60%, #7a0000 100%);
    box-shadow: 0 0 20px 8px rgba(255,0,0,0.6);
  }

  .green.on {
    background: radial-gradient(circle, #ddffdd, #00e000 60%, #007a00 100%);
    box-shadow: 0 0 20px 8px rgba(0,255,0,0.6);
  }

  /* â”€â”€â”€â”€â”€ ê¸°ë‘¥(ë³¸ì²´ì— ì™„ì „ ë°€ì°©) â”€â”€â”€â”€â”€ */
  .pole {
    width: 30px;         
    height: 200px;       
    background: #2e2e2e;
    box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
    margin-top: -1px;    /* ì™„ì „ ë°€ì°©! í‹ˆ 0 */
    border-radius: 10px;
  }

  /* â”€â”€â”€â”€â”€ ë°”ë‹¥ ë°›ì¹¨ (ê¸°ë‘¥ê³¼ ì™„ì „ ë°€ì°©) â”€â”€â”€â”€â”€ */
  .base {
    width: 90px;        
    height: 25px;       
    background: #2d2d2d;
    margin-top: -1px;   /* í‹ˆ ì—†ì´ ê¸°ë‘¥ì— ë¶™ì„ */
    border-radius: 18px;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
  }
</style>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyClsKru0-dRRl8ErV5vQx2vS31JFIV_OKM",
  authDomain: "traffic-light-demo-c070a.firebaseapp.com",
  databaseURL: "https://traffic-light-demo-c070a-default-rtdb.firebaseio.com",
  projectId: "traffic-light-demo-c070a",
  storageBucket: "traffic-light-demo-c070a.firebasestorage.app",
  messagingSenderId: "272853805092",
  appId: "1:272853805092:web:e95b87c470419a90d290b1",
  measurementId: "G-ZHQXT1WE0F"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ===== í‘œì‹œ ëª¨ë“œ ===== */
function displayMode() {
  db.ref("traffic").on("value", snap => {
    let state = snap.val();
    document.getElementById("red").classList.toggle("on", state === "red");
    document.getElementById("green").classList.toggle("on", state === "green");
  });
}

/* ===== ì œì–´ ëª¨ë“œ ===== */
function controlMode() {
  document.getElementById("btnRed").onclick = () => db.ref("traffic").set("red");
  document.getElementById("btnGreen").onclick = () => db.ref("traffic").set("green");
}

window.onload = () => {
  const mode = new URLSearchParams(window.location.search).get("mode");
  if (mode === "display") displayMode();
  if (mode === "control") controlMode();
};
</script>

</head>
<body>

<!-- ===== í‘œì‹œ í™”ë©´ ===== -->
<div class="traffic-wrap" id="display" style="display:none;">
  <div class="traffic-body">
    <div class="lamp-box">
      <div class="lamp red" id="red"></div>
    </div>
    <div class="lamp-box">
      <div class="lamp green" id="green"></div>
    </div>
  </div>

  <div class="pole"></div>
  <div class="base"></div>
</div>

<!-- ===== ì œì–´ í™”ë©´ ===== -->
<div id="control" style="display:none; text-align:center;">
  <button id="btnRed" style="font-size:30px;padding:20px;margin:20px;background:#ff4d4d;color:white;border:none;border-radius:10px;">ğŸ”´ ë¹¨ê°„ë¶ˆ</button>
  <button id="btnGreen" style="font-size:30px;padding:20px;margin:20px;background:#00cc44;color:white;border:none;border-radius:10px;">ğŸŸ¢ ì´ˆë¡ë¶ˆ</button>
</div>

<script>
const mode = new URLSearchParams(window.location.search).get("mode");
document.getElementById("display").style.display = mode === "display" ? "flex" : "none";
document.getElementById("control").style.display = mode === "control" ? "block" : "none";
</script>

</body>
</html>
